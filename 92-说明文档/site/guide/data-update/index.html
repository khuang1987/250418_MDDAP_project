<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Medtronic CZ Ops Team" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>数据更新流程 - CZ Ops 数字化数据平台 - 电子说明书</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../stylesheets/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u6570\u636e\u66f4\u65b0\u6d41\u7a0b";
        var mkdocs_page_input_path = "guide\\data-update.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> CZ Ops 数字化数据平台 - 电子说明书
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">首页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">KPI 核心指标</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../kpi/">KPI 指标体系</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >供应链 KPI</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/supply-chain/">供应链 KPI 总览</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/sa/">SA - 计划达成率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/inventory-turns/">IT - 库存周转率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/otd/">OTD - 准时交付率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/backlog/">BL - 积压订单</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/total-inventory/">TI - 总库存</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/supplier-performance/">SP - 供应商绩效</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/procurement-savings/">PS - 采购成本节约</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >生产 KPI</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/production/">生产 KPI 总览</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/oee/">OEE - 设备综合效率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/pcp/">PCP - 生产计划完成率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/cur/">CUR - 产能利用率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/cycle-time/">CT - 生产周期时间</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/mfg-variances/">MV - 制造差异</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/period-expense/">PE - 期间费用</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/labor-efficiency/">LE - 人工效率</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >质量 KPI</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/quality/">质量 KPI 总览</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/fpy/">FPY - 一次合格率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/ncr/">NCR - 不合格品率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/capa/">CAPA - CAPA 完成率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/ccr/">CCR - 客户投诉率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/rework/">RW - 返工率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/process-capability/">PCI - 过程能力指数</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >持续改进 KPI</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/ci/">持续改进 KPI 总览</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/ci-project/">CI-Project - 改善项目完成率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/cost-savings/">CS - 成本节约</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/employee-engagement/">EE - 员工参与度</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/project-cycle-time/">PCT - 项目周期时间</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/roi/">ROI - 投资回报率</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/innovation-proposals/">IP - 创新提案数</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../kpi/standardization-rate/">SR - 标准化率</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">报表说明</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../reports/">报表总览</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reports/completed/">已完成报表</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reports/guides/">报表使用指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reports/maintenance/">报表维护说明</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">技术实现</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >ETL 流程</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../etl/">ETL 概述</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../etl/etl-process/">ETL 流程说明</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../etl/etl-sa/">SA 数据清洗</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../etl/etl-sfc/">SFC 数据清洗</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../etl/standard-time/">标准时间处理</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../etl/configuration/">配置说明</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Power Query 代码</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../pq/">PQ 概述</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../pq/mes-records/">MES 报工记录</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../pq/sfc-records/">SFC 报工记录</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../pq/standard-time/">标准时间查询</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../pq/incremental-refresh/">增量刷新方案</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">项目记录</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >项目总览与进展</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../project/progress/">项目总览</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../project/progress/progress/">详细进展文档</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >DMAIC 阶段记录</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >定义阶段（Define）</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../project/01_Define_%E5%AE%9A%E4%B9%89%E9%98%B6%E6%AE%B5/">定义阶段概述</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../project/01_Define_%E5%AE%9A%E4%B9%89%E9%98%B6%E6%AE%B5/01_ProjectDefinition_%E9%A1%B9%E7%9B%AE%E5%AE%9A%E4%B9%89/">项目定义文档</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >测量阶段（Measure）</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../project/02_Measure_%E6%B5%8B%E9%87%8F%E9%98%B6%E6%AE%B5/">测量阶段概述</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../project/02_Measure_测量阶段/01_DataCollectionPlan_数据收集计划.md">数据收集计划</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../project/02_Measure_%E6%B5%8B%E9%87%8F%E9%98%B6%E6%AE%B5/02_KpiSpecification_KPI%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E/">KPI详细说明</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../project/02_Measure_%E6%B5%8B%E9%87%8F%E9%98%B6%E6%AE%B5/03_KpiMindmap_KPI%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/">KPI思维导图</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../project/02_Measure_%E6%B5%8B%E9%87%8F%E9%98%B6%E6%AE%B5/04_MeasurePhase_%E6%B5%8B%E9%87%8F%E9%98%B6%E6%AE%B5/">测量阶段文档</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../project/03_Analyze_%E5%88%86%E6%9E%90%E9%98%B6%E6%AE%B5/">分析阶段（Analyze）</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >改进阶段（Improve）</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../project/04_Improve_%E6%94%B9%E8%BF%9B%E9%98%B6%E6%AE%B5/">改进阶段概述</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../project/04_Improve_%E6%94%B9%E8%BF%9B%E9%98%B6%E6%AE%B5/01_ImprovementPlan_%E6%94%B9%E8%BF%9B%E6%96%B9%E6%A1%88/">改进方案</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >控制阶段（Control）</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../project/05_Control_%E6%8E%A7%E5%88%B6%E9%98%B6%E6%AE%B5/">控制阶段概述</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../project/05_Control_%E6%8E%A7%E5%88%B6%E9%98%B6%E6%AE%B5/01_ControlPlan_%E6%8E%A7%E5%88%B6%E8%AE%A1%E5%88%92/">控制计划</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >会议纪要</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../project/meetings/">会议纪要概述</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../project/meetings/meetings/">详细会议记录</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">参考资料</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/naming-convention/">文件命名规范</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../reference/dictionary/">字典表说明</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../changelog/">更新日志</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">CZ Ops 数字化数据平台 - 电子说明书</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">数据更新流程</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">数据更新流程<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>本文档详细说明如何更新数据平台的数据。</p>
<hr />
<h2 id="_2">更新流程概览<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<pre class="mermaid"><code>graph TD
    A[准备原始数据] --&gt; B{更新哪类数据?}
    B --&gt;|MES数据| C[上传MES文件到SharePoint]
    B --&gt;|SFC数据| D[上传SFC文件到SharePoint]
    B --&gt;|标准时间| E[上传Routing文件到SharePoint]

    C --&gt; F[运行 run_etl.bat]
    D --&gt; G[运行 etl_sfc.py]
    E --&gt; H[运行 convert_standard_time.py]

    G --&gt; F
    H --&gt; F

    F --&gt; I{处理成功?}
    I --&gt;|是| J[上传Parquet文件到publish文件夹]
    I --&gt;|否| K[查看日志排查问题]

    J --&gt; L[Power BI刷新数据]
    K --&gt; M[修复问题后重新运行]
    M --&gt; F

    style A fill:#e3f2fd
    style J fill:#e8f5e9
    style L fill:#c8e6c9
    style K fill:#ffebee</code></pre>
<hr />
<h2 id="1-mes">1. MES 数据更新（常规）<a class="headerlink" href="#1-mes" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 准备数据<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>从 MES 系统导出最新数据：</p>
<ul>
<li>文件名格式：<code>Product Output -CZM -FY26.xlsx</code></li>
<li>包含字段：BatchNumber、CFN、Operation、TrackOutTime 等</li>
<li>确保数据完整性</li>
</ul>
<h3 id="12-sharepoint">1.2 上传到 SharePoint<a class="headerlink" href="#12-sharepoint" title="Permanent link">&para;</a></h3>
<ol>
<li>打开 SharePoint</li>
<li>进入文件夹：<code>30-MES导出数据/30-MES</code></li>
<li>上传 Excel 文件</li>
<li>确认上传成功</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">注意</p>
<p>如果文件夹中已有同名文件，请选择覆盖或重命名。</p>
</div>
<h3 id="13-etl">1.3 运行 ETL 脚本<a class="headerlink" href="#13-etl" title="Permanent link">&para;</a></h3>
<h4 id="1">方法 1：使用批处理文件（推荐）<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<div class="language-batch highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a># 双击运行
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>10-SA指标/13-SA数据清洗/run_etl.bat
</span></code></pre></div>
<h4 id="2">方法 2：命令行运行<a class="headerlink" href="#2" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">cd</span><span class="w"> </span><span class="m">10</span>-SA指标/13-SA数据清洗
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>python<span class="w"> </span>etl_sa.py
</span></code></pre></div>
<h3 id="14">1.4 检查处理结果<a class="headerlink" href="#14" title="Permanent link">&para;</a></h3>
<h4 id="_3">查看控制台输出<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>========================================
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>  SA数据ETL处理 - 开始
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>========================================
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>[1/10] 加载配置文件...
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>✓ 配置加载成功
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>[2/10] 读取MES原始数据...
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>✓ 读取 123,456 条记录
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>[3/10] 合并SFC数据...
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>✓ 合并 Checkin_SFC 字段
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>[4/10] 匹配标准时间参数...
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>✓ 匹配 98.5% 的记录
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>[5/10] 计算LT、PT、ST...
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>✓ 计算完成
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>[6/10] 计算DueTime...
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>✓ 基于工作日日历计算完成
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>[7/10] 判断CompletionStatus...
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>✓ SA状态计算完成
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>[8/10] 数据质量检查...
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>✓ 通过质量检查
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>[9/10] 保存Parquet文件...
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>✓ 保存为: MES_处理后数据_20250110.parquet
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>[10/10] 完成!
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>========================================
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>  处理成功！
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>  - 输入记录: 123,456
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>  - 输出记录: 123,456
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>  - 处理时间: 3分52秒
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>========================================
</span></code></pre></div>
<h4 id="_4">查看日志文件<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># 查看日志</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>logs/etl_sa.log
</span></code></pre></div>
<p>日志示例：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>2025-01-10 10:30:15 - INFO - ETL处理开始
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>2025-01-10 10:30:16 - INFO - 读取MES数据: 123,456 条
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>2025-01-10 10:30:45 - INFO - 合并SFC数据: 匹配 85,234 条
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>2025-01-10 10:32:10 - INFO - 计算SA指标完成
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>2025-01-10 10:34:07 - INFO - 保存Parquet文件成功
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>2025-01-10 10:34:07 - INFO - ETL处理完成
</span></code></pre></div>
<h3 id="15">1.5 上传处理后文件<a class="headerlink" href="#15" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>找到生成的 Parquet 文件
   <div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>10-SA指标/13-SA数据清洗/publish/MES_处理后数据_latest.parquet
</span></code></pre></div></p>
</li>
<li>
<p>上传到 SharePoint</p>
</li>
<li>路径：<code>30-MES导出数据/publish/</code></li>
<li>文件名：<code>MES_处理后数据_latest.parquet</code></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">建议</p>
<p>保留日期备份：<code>MES_处理后数据_20250110.parquet</code></p>
</div>
<h3 id="16-power-bi">1.6 刷新 Power BI<a class="headerlink" href="#16-power-bi" title="Permanent link">&para;</a></h3>
<ol>
<li>打开 Power BI Desktop 或 Power BI Service</li>
<li>点击 <strong>刷新</strong> 按钮</li>
<li>等待刷新完成（通常 1-3 分钟）</li>
<li>验证数据更新</li>
</ol>
<hr />
<h2 id="2-sfc">2. SFC 数据更新<a class="headerlink" href="#2-sfc" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 准备数据<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<p>从 SFC 系统导出：</p>
<ul>
<li>文件名格式：<code>LC-yyyymmddhhmmss.csv</code></li>
<li>包含 Check In 时间等关键信息</li>
</ul>
<h3 id="22-sharepoint">2.2 上传到 SharePoint<a class="headerlink" href="#22-sharepoint" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>路径：70-SFC/
</span></code></pre></div>
<h3 id="23-sfc-etl">2.3 运行 SFC ETL<a class="headerlink" href="#23-sfc-etl" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nb">cd</span><span class="w"> </span><span class="m">10</span>-SA指标/13-SA数据清洗
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>python<span class="w"> </span>etl_sfc.py
</span></code></pre></div>
<p>或双击：<code>run_all_etl.bat</code>（会依次处理 SFC 和 MES）</p>
<h3 id="24">2.4 处理结果<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<p>生成文件：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>publish/SFC_处理后数据_latest.parquet
</span></code></pre></div>
<h3 id="25-mes">2.5 重新处理 MES<a class="headerlink" href="#25-mes" title="Permanent link">&para;</a></h3>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>SFC 数据更新后，<strong>必须重新运行 MES ETL</strong>，因为 MES 需要合并 SFC 的 Checkin_SFC 字段。</p>
</div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>python<span class="w"> </span>etl_sa.py
</span></code></pre></div>
<hr />
<h2 id="3">3. 标准时间更新<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 准备数据<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p>更新 Excel 文件：</p>
<ul>
<li>文件名：<code>1303 Routing及机加工产品清单.xlsx</code></li>
<li>包含两个 Sheet：</li>
<li><code>1303 Routing</code>：Machine、Labor 时间</li>
<li><code>1303机加工清单</code>：OEE、Setup Time</li>
</ul>
<h3 id="32-sharepoint">3.2 上传到 SharePoint<a class="headerlink" href="#32-sharepoint" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>路径：30-MES导出数据/30-MES/
</span></code></pre></div>
<h3 id="33">3.3 运行转换脚本<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nb">cd</span><span class="w"> </span><span class="m">10</span>-SA指标/13-SA数据清洗
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>python<span class="w"> </span>convert_standard_time.py
</span></code></pre></div>
<p>或双击：<code>convert_standard_time.bat</code></p>
<h3 id="34">3.4 处理结果<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<p>生成文件：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>publish/SAP_Routing_20250110.parquet
</span></code></pre></div>
<h3 id="35-mes">3.5 重新处理 MES<a class="headerlink" href="#35-mes" title="Permanent link">&para;</a></h3>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>标准时间更新后，<strong>必须重新运行 MES ETL</strong>，以匹配最新的标准时间参数。</p>
</div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>python<span class="w"> </span>etl_sa.py
</span></code></pre></div>
<hr />
<h2 id="4-vs">4. 增量更新 vs 全量更新<a class="headerlink" href="#4-vs" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 增量更新（推荐）<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<p><strong>适用场景：</strong>
- 日常数据更新
- 只更新最近数据（如最近 7 天）</p>
<p><strong>优点：</strong>
- 处理速度快
- 资源消耗少</p>
<p><strong>配置方法：</strong></p>
<p>编辑 <code>config/config.yaml</code>：</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># 增量更新设置</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nt">incremental_update</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="nt">incremental_days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span><span class="w">  </span><span class="c1"># 更新最近7天</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># 或指定日期范围</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="nt">start_date</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-01-01&quot;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="nt">end_date</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2025-01-10&quot;</span>
</span></code></pre></div>
<h3 id="42">4.2 全量更新<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<p><strong>适用场景：</strong>
- 初次加载
- 标准时间或 SFC 数据更新后
- 历史数据修正</p>
<p><strong>配置方法：</strong></p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nt">incremental_update</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span></code></pre></div>
<hr />
<h2 id="5">5. 更新频率建议<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>建议频率</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>MES 数据</td>
<td>每日/每周</td>
<td>根据业务需求</td>
</tr>
<tr>
<td>SFC 数据</td>
<td>每周/每月</td>
<td>更新较少</td>
</tr>
<tr>
<td>标准时间</td>
<td>按需更新</td>
<td>SAP Routing 变更时</td>
</tr>
<tr>
<td>工作日日历</td>
<td>每年初</td>
<td>更新下一年度日历</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="6">6. 批量更新流程<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<p>如果需要更新所有数据：</p>
<h3 id="61">6.1 使用一键更新脚本<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># 双击运行</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>run_all_etl.bat
</span></code></pre></div>
<p>脚本会依次执行：</p>
<ol>
<li><code>etl_sfc.py</code> - 处理 SFC 数据</li>
<li><code>etl_sa.py</code> - 处理 MES 数据（合并 SFC）</li>
<li>生成所有 Parquet 文件</li>
</ol>
<h3 id="62">6.2 手动批量更新<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># 1. 更新标准时间</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>python<span class="w"> </span>convert_standard_time.py
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># 2. 处理 SFC</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>python<span class="w"> </span>etl_sfc.py
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c1"># 3. 处理 MES</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>python<span class="w"> </span>etl_sa.py
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="c1"># 4. 上传所有 Parquet 文件到 SharePoint</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="c1"># 5. 刷新 Power BI</span>
</span></code></pre></div>
<hr />
<h2 id="7">7. 验证数据更新<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-parquet">7.1 检查 Parquet 文件<a class="headerlink" href="#71-parquet" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1"># 读取处理后数据</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;publish/MES_处理后数据_latest.parquet&#39;</span><span class="p">)</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c1"># 检查记录数</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;总记录数: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="c1"># 检查日期范围</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最早日期: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TrackOutDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;最晚日期: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TrackOutDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="c1"># 检查SA状态</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;按期批次: </span><span class="si">{</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CompletionStatus&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;OnTime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;逾期批次: </span><span class="si">{</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CompletionStatus&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Overdue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="72-power-bi">7.2 检查 Power BI<a class="headerlink" href="#72-power-bi" title="Permanent link">&para;</a></h3>
<ul>
<li>查看最新日期的数据</li>
<li>验证 SA 达成率</li>
<li>检查异常值</li>
</ul>
<hr />
<h2 id="8">8. 常见问题<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="1etl">问题 1：ETL 运行失败<a class="headerlink" href="#1etl" title="Permanent link">&para;</a></h3>
<p><strong>排查步骤：</strong></p>
<ol>
<li>查看错误信息</li>
<li>检查日志文件：<code>logs/etl_sa.log</code></li>
<li>参考：<a href="../troubleshooting/">故障排查指南</a></li>
</ol>
<h3 id="2power-bi">问题 2：Power BI 刷新失败<a class="headerlink" href="#2power-bi" title="Permanent link">&para;</a></h3>
<p><strong>排查步骤：</strong></p>
<ol>
<li>检查 Parquet 文件是否存在</li>
<li>检查 SharePoint 权限</li>
<li>检查 Power Query 连接路径</li>
</ol>
<h3 id="3_1">问题 3：数据不一致<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h3>
<p><strong>排查步骤：</strong></p>
<ol>
<li>确认使用的是 <code>_latest.parquet</code> 文件</li>
<li>检查 Power BI 刷新时间</li>
<li>对比 Parquet 文件和 Power BI 中的记录数</li>
</ol>
<hr />
<h2 id="9">9. 自动化更新（进阶）<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91-windows">9.1 使用 Windows 任务计划程序<a class="headerlink" href="#91-windows" title="Permanent link">&para;</a></h3>
<ol>
<li>打开 <strong>任务计划程序</strong></li>
<li>创建基本任务</li>
<li>设置触发器（如每天凌晨 2:00）</li>
<li>操作：运行 <code>run_etl.bat</code></li>
</ol>
<h3 id="92-python">9.2 使用 Python 定时任务<a class="headerlink" href="#92-python" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">schedule</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_etl</span><span class="p">():</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;python etl_sa.py&#39;</span><span class="p">)</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="c1"># 每天凌晨 2:00 运行</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="n">schedule</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;02:00&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">run_etl</span><span class="p">)</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    <span class="n">schedule</span><span class="o">.</span><span class="n">run_pending</span><span class="p">()</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="10">10. 最佳实践<a class="headerlink" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 数据更新前<a class="headerlink" href="#101" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ 备份当前数据</li>
<li>✅ 检查原始数据质量</li>
<li>✅ 确认 SharePoint 连接</li>
</ul>
<h3 id="102">10.2 数据更新中<a class="headerlink" href="#102" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ 监控 ETL 进度</li>
<li>✅ 查看日志输出</li>
<li>✅ 不要中断处理</li>
</ul>
<h3 id="103">10.3 数据更新后<a class="headerlink" href="#103" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ 验证 Parquet 文件</li>
<li>✅ 测试 Power BI 刷新</li>
<li>✅ 检查数据质量</li>
<li>✅ 记录更新日志</li>
</ul>
<hr />
<h2 id="_5">相关链接<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="../../etl/etl-process/">ETL 处理流程</a></li>
<li><a href="../../etl/configuration/">配置说明</a></li>
<li><a href="../troubleshooting/">故障排查</a></li>
<li><a href="../faq/">常见问题</a></li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="../../javascripts/mathjax.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
